<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都必须跟随其后！ -->
    <title>超市管理系统-销量报表</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">

</head>
<body>
<header id="header"></header>

<div class="main-container">
    <div id="errorMsg" class="alert alert-danger" role="alert" style="display: none;"></div>
    <div class="tool-container">
        <form class="form-inline" action="javascript:void(0)">
<!--            <div class="form-group">-->
<!--                <label for="inputGname">商品编号</label>-->
<!--                <input type="text" class="form-control" id="inputGid" placeholder="商品ID">-->
<!--            </div>-->
<!--            <div class="form-group">-->
<!--                <label for="inputGname">商品名</label>-->
<!--                <input type="text" class="form-control" id="inputGname" placeholder="商品名">-->
<!--            </div>-->
<!--            <div class="form-group">-->
<!--                <label for="selectCatagory">分类</label>-->
<!--                <select class="form-control" id="selectCatagory">-->
<!--                </select>-->
<!--            </div>-->
<!--            <div class="form-group">-->
<!--                <label for="selectSupplier">供应商</label>-->
<!--                <select class="form-control" id="selectSupplier">-->
<!--                </select>-->
<!--            </div>-->
            <div class="form-group">
                <label for="dateStart">起始日期</label>
                <input type="date" class="form-control" id="dateStart">
            </div>
            <div class="form-group">
                <label for="dateEnd">终止日期</label>
                <input type="date" class="form-control" id="dateEnd">
            </div>
            <button class="btn btn-default" onclick="javascript:search()">查询</button>
<!--            <div style="display: inline;">-->
<!--                <button type="button" class="btn btn-primary" onclick="newGood()">新建</button>-->
<!--                <button type="button" class="btn btn-danger" onclick="deleteSelected()">删除选中</button>-->
<!--            </div>-->
        </form>
    </div>
    <div class="table-container">
        <table class="table table-hover">
            <thead>
            <tr>
                <th>商品ID</th>
                <th>商品名</th>
                <th>分类</th>
                <th>供应商</th>
                <th>零售价</th>
                <th>销量</th>
            </tr>
            </thead>
            <tbody id="goodBody">
            </tbody>
        </table>
    </div>
</div>


<!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
<script src="js/jquery-3.5.1.min.js"></script>
<!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
<script src="js/bootstrap.min.js"></script>
<script src="js/include.js" type="application/javascript"></script>
<script type="application/javascript">
    $(function (){
        var date = new Date();
        var year = date.getFullYear();
        var month = date.getMonth()+1;
        var day = date.getDate();
        $("#dateStart").val("2000-01-01");
        $("#dateEnd").val(year+'-'+month+'-'+day);

        search();
    });

    function search() {
        var dateStart = $("#dateStart").val();
        var dateEnd = $("#dateEnd").val();

        var goodBody = $("#goodBody");
        $.get("/good/getSaleReport",{'dateStart':dateStart,'dateEnd':dateEnd},function (map) {
            for(var goodId in map){
                $.get("/good/getById",{'gid':goodId},function (data){
                    var tr= document.createElement('tr');
                    if (data.category==null){
                        ctname = '未分类';
                    } else {
                        ctname = data.category.categoryName;
                    }
                    if (data.supplier==null) {
                        spname = '未指定';
                    } else {
                        spname = data.supplier.supplierName;
                    }

                    tr.innerHTML =
                        '                <td>'+data.goodId+'</td>\n' +
                        '                <td>'+data.goodName+'</td>\n' +
                        '                <td>'+ctname+'</td>\n' +
                        '                <td>'+spname+'</td>\n' +
                        '                <td>'+data.retailPrice+'</td>\n' +
                        '                <td>'+map[goodId]+'</td>\n';
                    goodBody.append(tr);
                });
            }
        });
    }
</script>
</body>
</html>